<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ESCP 9710 R Labs - 5&nbsp; Confirmatory Factor Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sem.html" rel="next">
<link href="./modelevaluation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ESCP 9710 R Labs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/people.html" rel="" target="">
 <span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/talks.html" rel="" target="">
 <span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-labs">    
        <li>
    <a class="dropdown-item" href="https://winterstat.github.io/escp8082_rlabs" rel="" target="">
 <span class="dropdown-text">ESCP 8082 Foundations of Measurement</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/winterstat" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/winterstat" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./confirmatoryfactoranalysis.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Confirmatory Factor Analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gettingstarted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Path Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indirecteffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Indirect Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelevaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model Evaluation and Comparison</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confirmatoryfactoranalysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Confirmatory Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Structural Equation Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurementinvariance_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Measurement Invariance Testing with Continuous Indicators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Structural after Measurement Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latentgrowthmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Latent Growth Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurementinvariance_ord.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Measurement Invariance Testing with Ordinal Indicators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lpa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Latent Profile Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Latent Class Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link active" data-scroll-target="#loading-r-packages"><span class="header-section-number">5.1</span> Loading R packages</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">5.2</span> Loading Data</a></li>
  <li><a href="#unidimensional-cfa" id="toc-unidimensional-cfa" class="nav-link" data-scroll-target="#unidimensional-cfa"><span class="header-section-number">5.3</span> Unidimensional CFA</a>
  <ul class="collapse">
  <li><a href="#model-specification" id="toc-model-specification" class="nav-link" data-scroll-target="#model-specification">Model Specification</a></li>
  <li><a href="#model-estimation" id="toc-model-estimation" class="nav-link" data-scroll-target="#model-estimation">Model Estimation</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a></li>
  </ul></li>
  <li><a href="#two-correlated-factors-cfa" id="toc-two-correlated-factors-cfa" class="nav-link" data-scroll-target="#two-correlated-factors-cfa"><span class="header-section-number">5.4</span> Two Correlated Factors CFA</a>
  <ul class="collapse">
  <li><a href="#model-respecification-and-estimation" id="toc-model-respecification-and-estimation" class="nav-link" data-scroll-target="#model-respecification-and-estimation">Model (re)Specification and Estimation</a></li>
  <li><a href="#model-evaluation-1" id="toc-model-evaluation-1" class="nav-link" data-scroll-target="#model-evaluation-1">Model Evaluation</a></li>
  </ul></li>
  <li><a href="#model-comparison" id="toc-model-comparison" class="nav-link" data-scroll-target="#model-comparison"><span class="header-section-number">5.5</span> Model Comparison</a></li>
  <li><a href="#introducing-cross-loadings-or-residual-covariances" id="toc-introducing-cross-loadings-or-residual-covariances" class="nav-link" data-scroll-target="#introducing-cross-loadings-or-residual-covariances"><span class="header-section-number">5.6</span> Introducing Cross-Loadings or Residual Covariances</a>
  <ul class="collapse">
  <li><a href="#model-respecification-and-estimation-1" id="toc-model-respecification-and-estimation-1" class="nav-link" data-scroll-target="#model-respecification-and-estimation-1">Model (re)Specification and Estimation</a></li>
  <li><a href="#model-evaluation-2" id="toc-model-evaluation-2" class="nav-link" data-scroll-target="#model-evaluation-2">Model Evaluation</a></li>
  <li><a href="#model-comparison-1" id="toc-model-comparison-1" class="nav-link" data-scroll-target="#model-comparison-1">Model Comparison</a></li>
  </ul></li>
  <li><a href="#approximate-fit-indices" id="toc-approximate-fit-indices" class="nav-link" data-scroll-target="#approximate-fit-indices"><span class="header-section-number">5.7</span> Approximate Fit Indices</a></li>
  <li><a href="#estimate-interpretation" id="toc-estimate-interpretation" class="nav-link" data-scroll-target="#estimate-interpretation"><span class="header-section-number">5.8</span> Estimate Interpretation</a></li>
  <li><a href="#reliability-based-on-factor-models" id="toc-reliability-based-on-factor-models" class="nav-link" data-scroll-target="#reliability-based-on-factor-models"><span class="header-section-number">5.9</span> Reliability based on factor models</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.10</span> Summary</a></li>
  <li><a href="#bonus-adding-a-residual-covariance" id="toc-bonus-adding-a-residual-covariance" class="nav-link" data-scroll-target="#bonus-adding-a-residual-covariance"><span class="header-section-number">5.11</span> Bonus: Adding a residual covariance</a>
  <ul class="collapse">
  <li><a href="#model-evaluation-3" id="toc-model-evaluation-3" class="nav-link" data-scroll-target="#model-evaluation-3">Model Evaluation</a></li>
  <li><a href="#model-comparison-2" id="toc-model-comparison-2" class="nav-link" data-scroll-target="#model-comparison-2">Model Comparison</a></li>
  <li><a href="#estimate-interpretation-1" id="toc-estimate-interpretation-1" class="nav-link" data-scroll-target="#estimate-interpretation-1">Estimate Interpretation</a></li>
  <li><a href="#reliability-based-on-factor-models-1" id="toc-reliability-based-on-factor-models-1" class="nav-link" data-scroll-target="#reliability-based-on-factor-models-1">Reliability based on factor models</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Confirmatory Factor Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can download the R code used in this lab by right-clicking this link and selecting “Save Link As…” in the drop-down menu: <a href="https://winterstat.github.io/escp8082_rlabs/data/confirmatoryfactoranalysis.R">confirmatoryfactoranalysis.R</a></p>
</div>
</div>
<section id="loading-r-packages" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="loading-r-packages"><span class="header-section-number">5.1</span> Loading R packages</h2>
<p>Load the required packages for this lab into your R environment:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semhelpinghands)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="loading-data"><span class="header-section-number">5.2</span> Loading Data</h2>
<p>Load the data into your environment. For this lab we will use the data that was also used in the book chapter example: a sample of 200 children who completed the KABC (Kaufman Assessment Battery for Children), which includes eight subtests: Hand Movements (hm), Number Recall (nr), Word Order (wo), Gestalt Closure (gc), Triangles (tr), Spatial Memory (sm), Matrix Analogies (ma), and Photo Series (ps).</p>
<p>You can download the data by right-clicking this link and selecting “Save Link As…” in the drop-down menu: <a href="https://winterstat.github.io/escp8082_rlabs/data/kabc.csv">data/kabc.csv</a>. Make sure to save it in the folder you are using for this class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>kabc <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="at">file =</span> <span class="st">"data/kabc.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="unidimensional-cfa" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="unidimensional-cfa"><span class="header-section-number">5.3</span> Unidimensional CFA</h2>
<section id="model-specification" class="level3">
<h3 class="anchored" data-anchor-id="model-specification">Model Specification</h3>
<p>Next, we will specify a single factor CFA using lavaan syntax. We will use a new operator, <code>=~</code>, which tells <code>lavaan</code> that we are specifying a reflective latent factor. You can give the factor any name you want and put it on the left side of <code>=~</code>. All the indicators of the latent factor go on the right side of <code>=~</code> with <code>+</code>s in between:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">CogA =~ hm + nr + wo + gc + tr + sm + ma + ps</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-estimation" class="level3">
<h3 class="anchored" data-anchor-id="model-estimation">Model Estimation</h3>
<p>Next, we will estimate the model using different model identification constraints. We will start with <code>lavaan</code>’s default: the reference variable method (or unit loading identification). To use this method, we do not need to add anything to our model estimation function, <code>cfa</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fit1a <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod1, <span class="at">data =</span> kabc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To estimate the same model using a unit variance identification constraint, we can change the code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit1b <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod1, <span class="at">data =</span> kabc, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, to estimate the same model using effect coding identification constraints, we can change the code as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit1c <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod1, <span class="at">data =</span> kabc, </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">effect.coding =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Are all these models equivalent? We can use the <code>net()</code> function to check:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">net</span>(fit1a, fit1b, fit1c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        If cell [R, C] is TRUE, the model in row R is nested within column C.

        If the models also have the same degrees of freedom, they are equivalent.

        NA indicates the model in column C did not converge when fit to the
        implied means and covariance matrix from the model in row R.

        The hidden diagonal is TRUE because any model is equivalent to itself.
        The upper triangle is hidden because for models with the same degrees
        of freedom, cell [C, R] == cell [R, C].  For all models with different
        degrees of freedom, the upper diagonal is all FALSE because models with
        fewer degrees of freedom (i.e., more parameters) cannot be nested
        within models with more degrees of freedom (i.e., fewer parameters).
        
                fit1a fit1b fit1c
fit1a (df = 20)                  
fit1b (df = 20) TRUE             
fit1c (df = 20) TRUE  TRUE       </code></pre>
</div>
</div>
<p>To quickly compare the parameter estimates across model identification options, we can use the <code>group_by_models()</code> function from the <code>semhelpinghands</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by_models</span>(<span class="fu">list</span>(<span class="st">"marker"</span> <span class="ot">=</span> fit1a, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"variance"</span> <span class="ot">=</span> fit1b,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"effect"</span> <span class="ot">=</span> fit1c))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op  rhs est_marker est_variance est_effect
1  CogA =~   gc      0.659        1.265      0.699
2  CogA =~   hm      1.000        1.921      1.060
3  CogA =~   ma      0.883        1.696      0.936
4  CogA =~   nr      0.636        1.221      0.674
5  CogA =~   ps      1.166        2.240      1.237
6  CogA =~   sm      1.433        2.752      1.519
7  CogA =~   tr      0.963        1.850      1.021
8  CogA =~   wo      0.805        1.547      0.854
9  CogA ~~ CogA      3.690        1.000      3.282
10   gc ~~   gc      5.652        5.652      5.652
11   hm ~~   hm      7.812        7.812      7.812
12   ma ~~   ma      4.925        4.925      4.925
13   nr ~~   nr      4.240        4.240      4.240
14   ps ~~   ps      3.936        3.936      3.936
15   sm ~~   sm      9.979        9.979      9.979
16   tr ~~   tr      3.831        3.831      3.831
17   wo ~~   wo      5.975        5.975      5.975</code></pre>
</div>
</div>
<p>A nice way to confirm that the models are identical is to compare the standardized estimates across the different options:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by_models</span>(<span class="fu">list</span>(<span class="st">"marker"</span> <span class="ot">=</span> fit1a,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"variance"</span> <span class="ot">=</span> fit1b,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"effect"</span> <span class="ot">=</span> fit1c),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">use_standardizedSolution =</span> <span class="cn">TRUE</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_names =</span> <span class="st">"est.std"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op  rhs est.std_marker est.std_variance est.std_effect
1  CogA =~   gc          0.470            0.470          0.470
2  CogA =~   hm          0.566            0.566          0.566
3  CogA =~   ma          0.607            0.607          0.607
4  CogA =~   nr          0.510            0.510          0.510
5  CogA =~   ps          0.749            0.749          0.749
6  CogA =~   sm          0.657            0.657          0.657
7  CogA =~   tr          0.687            0.687          0.687
8  CogA =~   wo          0.535            0.535          0.535
9  CogA ~~ CogA          1.000            1.000          1.000
10   gc ~~   gc          0.779            0.779          0.779
11   hm ~~   hm          0.679            0.679          0.679
12   ma ~~   ma          0.631            0.631          0.631
13   nr ~~   nr          0.740            0.740          0.740
14   ps ~~   ps          0.440            0.440          0.440
15   sm ~~   sm          0.569            0.569          0.569
16   tr ~~   tr          0.528            0.528          0.528
17   wo ~~   wo          0.714            0.714          0.714</code></pre>
</div>
</div>
</section>
<section id="model-evaluation" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h3>
<p>Here, we will follow the steps described in the textbook.</p>
<section id="global-fit" class="level4">
<h4 class="anchored" data-anchor-id="global-fit">Global Fit</h4>
<p>First, we will test the exact fit of the model to the data using the Chi-square model test. We can find this statistic by including <code>fit.measures = T</code> in the <code>summary()</code> function and finding the section labeled <code>Model Test User Model</code>. Note that I also set <code>estimates = F</code>, so that the parameter estimates are not included in the output (mostly to reduce the length of the output):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1a, <span class="at">fit.measures =</span> T, <span class="at">estimates =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 36 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        16

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                               105.427
  Degrees of freedom                                20
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               498.336
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.818
  Tucker-Lewis Index (TLI)                       0.746

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3812.592
  Loglikelihood unrestricted model (H1)      -3759.878
                                                      
  Akaike (AIC)                                7657.183
  Bayesian (BIC)                              7709.956
  Sample-size adjusted Bayesian (SABIC)       7659.267

Root Mean Square Error of Approximation:

  RMSEA                                          0.146
  90 Percent confidence interval - lower         0.119
  90 Percent confidence interval - upper         0.174
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.084</code></pre>
</div>
</div>
<p><strong>What does the Chi-square test tell us about the exact fit of this model?</strong></p>
</section>
<section id="local-fit" class="level4">
<h4 class="anchored" data-anchor-id="local-fit">Local Fit</h4>
<p>To identify where the friction between the data and the model might be, we can look at local fit using the covariance residuals. It can be helpful to compare results across different methods, so we will use the normalized residuals and the correlation residuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit1a, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  1.331  0.000                                          
wo  0.629  4.667  0.000                                   
gc -0.777 -1.823 -1.274  0.000                            
tr -0.930 -1.098 -1.050  0.757  0.000                     
sm  0.367 -0.613 -0.970 -0.117  0.240  0.000              
ma  0.608  0.138 -0.334  0.334  0.038  0.147  0.000       
ps -0.448 -1.249 -0.402  0.890  0.804  0.230 -0.450  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit1a, <span class="at">type =</span> <span class="st">"cor.bollen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  0.101  0.000                                          
wo  0.047  0.397  0.000                                   
gc -0.056 -0.130 -0.091  0.000                            
tr -0.069 -0.080 -0.077  0.057  0.000                     
sm  0.028 -0.045 -0.071 -0.009  0.019  0.000              
ma  0.046  0.010 -0.025  0.025  0.003  0.011  0.000       
ps -0.034 -0.092 -0.030  0.068  0.066  0.018 -0.035  0.000</code></pre>
</div>
</div>
<p><strong>What patterns can you see in the covariance residuals? Do you think a different CFA would be more appropriate?</strong></p>
</section>
</section>
</section>
<section id="two-correlated-factors-cfa" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="two-correlated-factors-cfa"><span class="header-section-number">5.4</span> Two Correlated Factors CFA</h2>
<p>Lets examine the hypothesis that there are two correlated factors underlying the KABC subtests.</p>
<section id="model-respecification-and-estimation" class="level3">
<h3 class="anchored" data-anchor-id="model-respecification-and-estimation">Model (re)Specification and Estimation</h3>
<p>When we specify a two-facor CFA in <code>lavaan</code> we don’t need to include the covariance between the factors in the syntax; it will be included automatically. So, all we need to do is specify the two factors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="st">Sequent =~ hm + nr + wo</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">Simult =~ gc + tr + sm + ma + ps</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can estimate the model and save it in <code>fit2a</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fit2a <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod2, <span class="at">data =</span> kabc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-evaluation-1" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation-1">Model Evaluation</h3>
<p>We will use the same sources of information to evaluate the fit of this modified model.</p>
<section id="global-fit-1" class="level4">
<h4 class="anchored" data-anchor-id="global-fit-1">Global Fit</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2a, <span class="at">fit.measures =</span> T,  <span class="at">estimates =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 43 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        17

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                                38.325
  Degrees of freedom                                19
  P-value (Chi-square)                           0.005

Model Test Baseline Model:

  Test statistic                               498.336
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.959
  Tucker-Lewis Index (TLI)                       0.939

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3779.041
  Loglikelihood unrestricted model (H1)      -3759.878
                                                      
  Akaike (AIC)                                7592.082
  Bayesian (BIC)                              7648.153
  Sample-size adjusted Bayesian (SABIC)       7594.295

Root Mean Square Error of Approximation:

  RMSEA                                          0.071
  90 Percent confidence interval - lower         0.038
  90 Percent confidence interval - upper         0.104
  P-value H_0: RMSEA &lt;= 0.050                    0.132
  P-value H_0: RMSEA &gt;= 0.080                    0.358

Standardized Root Mean Square Residual:

  SRMR                                           0.072</code></pre>
</div>
</div>
<p><strong>What does the Chi-square test tell us about the exact fit of this model?</strong></p>
</section>
<section id="local-fit-1" class="level4">
<h4 class="anchored" data-anchor-id="local-fit-1">Local Fit</h4>
<p>We can examine to what extend new factor structure addressed local fit issues:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit2a, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr -0.144  0.000                                          
wo -0.687  0.209  0.000                                   
gc  0.981 -1.631 -0.927  0.000                            
tr  1.603 -0.772 -0.502  0.194  0.000                     
sm  2.869 -0.066 -0.208 -0.405 -0.084  0.000              
ma  2.996  0.751  0.479  0.194 -0.092  0.318  0.000       
ps  2.289 -0.833  0.241  0.350  0.148 -0.036 -0.516  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit2a, <span class="at">type =</span> <span class="st">"cor.bollen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr -0.011  0.000                                          
wo -0.051  0.018  0.000                                   
gc  0.071 -0.116 -0.066  0.000                            
tr  0.119 -0.057 -0.037  0.015  0.000                     
sm  0.219 -0.005 -0.015 -0.030 -0.007  0.000              
ma  0.227  0.056  0.035  0.014 -0.007  0.024  0.000       
ps  0.174 -0.061  0.018  0.027  0.012 -0.003 -0.040  0.000</code></pre>
</div>
</div>
<p><strong>What patterns can you see in the covariance residuals? What path could we add to the model?</strong></p>
</section>
</section>
</section>
<section id="model-comparison" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="model-comparison"><span class="header-section-number">5.5</span> Model Comparison</h2>
<p>We can also use the Chi-square difference test to compare the original and modified CFA to each other. Here, the original one-factor CFA model is more constrained and the modified two-factor CFA model is less constrained. Here, a significant Chi-square difference indicates that the more constrained one-factor model fits significantly <em>worse</em> than the two-factor model. We can use the <code>compareFit()</code> function from the <code>semTools</code> package to compare the models using the Chi-square difference test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>comp12 <span class="ot">&lt;-</span> <span class="fu">compareFit</span>(fit1a, fit2a)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

      Df    AIC    BIC   Chisq Chisq diff  RMSEA Df diff Pr(&gt;Chisq)    
fit2a 19 7592.1 7648.2  38.325                                         
fit1a 20 7657.2 7710.0 105.427     67.102 0.5749       1  2.578e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

####################### Model Fit Indices ###########################
         chisq df pvalue rmsea   cfi   tli  srmr       aic       bic
fit2a  38.325† 19   .005 .071† .959† .939† .072† 7592.082† 7648.153†
fit1a 105.427  20   .000 .146  .818  .746  .084  7657.183  7709.956 

################## Differences in Fit Indices #######################
              df rmsea    cfi    tli  srmr    aic    bic
fit1a - fit2a  1 0.075 -0.141 -0.194 0.011 65.102 61.804</code></pre>
</div>
</div>
<p><strong>Does the less constrained two-factor model result in an improvement in global fit?</strong></p>
</section>
<section id="introducing-cross-loadings-or-residual-covariances" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="introducing-cross-loadings-or-residual-covariances"><span class="header-section-number">5.6</span> Introducing Cross-Loadings or Residual Covariances</h2>
<p>Even though the two-factor CFA fits better than the one-factor CFA, it’s Model Chi-square test is still significant, indicating that it is not an exact fit to the data. We can use the local fit information to help us decide what kind of theory-informed alterations might be reasonable to add. One option is to include a cross-loading of Hand Movements (which has its main loading on the Sequential factor): The task requires exact reproduction of a sequence of hand movements performed by the examiner, but there is also a clear visual-spatial component to the task that could reflect simultaneous processing. A second option is to include a residual covariance between Number Recall and Word Order. It might be that both these tasks require memorization, which may not be a component that they share with Hand Movements.</p>
<section id="model-respecification-and-estimation-1" class="level3">
<h3 class="anchored" data-anchor-id="model-respecification-and-estimation-1">Model (re)Specification and Estimation</h3>
<p>For the purpose of this lab, we will add the cross-loading:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="st">Sequent =~ hm + nr + wo</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="st">Simult =~ gc + tr + sm + ma + ps + hm </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can estimate the model and save it in <code>fit3a</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit3a <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod3, <span class="at">data =</span> kabc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="model-evaluation-2" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation-2">Model Evaluation</h3>
<p>We will use the same sources of information to evaluate the fit of this modified model.</p>
<section id="global-fit-2" class="level4">
<h4 class="anchored" data-anchor-id="global-fit-2">Global Fit</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3a, <span class="at">fit.measures =</span> T, <span class="at">estimates =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 49 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                                18.108
  Degrees of freedom                                18
  P-value (Chi-square)                           0.449

Model Test Baseline Model:

  Test statistic                               498.336
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3768.932
  Loglikelihood unrestricted model (H1)      -3759.878
                                                      
  Akaike (AIC)                                7573.864
  Bayesian (BIC)                              7633.234
  Sample-size adjusted Bayesian (SABIC)       7576.208

Root Mean Square Error of Approximation:

  RMSEA                                          0.005
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.063
  P-value H_0: RMSEA &lt;= 0.050                    0.859
  P-value H_0: RMSEA &gt;= 0.080                    0.008

Standardized Root Mean Square Residual:

  SRMR                                           0.035</code></pre>
</div>
</div>
<p><strong>What does the Chi-square test tell us about the exact fit of this model?</strong></p>
</section>
<section id="local-fit-2" class="level4">
<h4 class="anchored" data-anchor-id="local-fit-2">Local Fit</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit3a, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  0.270  0.000                                          
wo -0.270  0.000  0.000                                   
gc -0.688 -1.380 -0.678  0.000                            
tr -0.713 -0.395 -0.130  0.286  0.000                     
sm  0.706  0.169  0.026 -0.443 -0.099  0.000              
ma  1.044  0.955  0.682  0.154 -0.115  0.155  0.000       
ps -0.181 -0.457  0.606  0.418  0.280 -0.091 -0.577  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit3a, <span class="at">type =</span> <span class="st">"cor.bollen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  0.020  0.000                                          
wo -0.020  0.000  0.000                                   
gc -0.050 -0.098 -0.049  0.000                            
tr -0.053 -0.029 -0.010  0.022  0.000                     
sm  0.054  0.012  0.002 -0.033 -0.008  0.000              
ma  0.079  0.071  0.050  0.011 -0.009  0.012  0.000       
ps -0.014 -0.034  0.046  0.032  0.023 -0.007 -0.044  0.000</code></pre>
</div>
</div>
<p><strong>What patterns can you see in the covariance residuals? Do we need to consider any more adjustments?</strong></p>
</section>
</section>
<section id="model-comparison-1" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-1">Model Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>comp23 <span class="ot">&lt;-</span> <span class="fu">compareFit</span>(fit3a, fit2a)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp23)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

      Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit3a 18 7573.9 7633.2 18.108                                          
fit2a 19 7592.1 7648.2 38.325     20.217 0.30998       1  6.913e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

####################### Model Fit Indices ###########################
        chisq df pvalue rmsea    cfi    tli  srmr       aic       bic
fit3a 18.108† 18   .449 .005† 1.000† 1.000† .035† 7573.864† 7633.234†
fit2a 38.325  19   .005 .071   .959   .939  .072  7592.082  7648.153 

################## Differences in Fit Indices #######################
              df rmsea    cfi   tli  srmr    aic    bic
fit2a - fit3a  1 0.066 -0.041 -0.06 0.037 18.217 14.919</code></pre>
</div>
</div>
<p><strong>Does the modified (less constrained) model result in an improvement in global fit?</strong></p>
</section>
</section>
<section id="approximate-fit-indices" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="approximate-fit-indices"><span class="header-section-number">5.7</span> Approximate Fit Indices</h2>
<p>So far, we have ignored the approximate fit indices that are reported by <code>lavaan</code>. We can get a quick overview of these indices across the three main models we have specified by using the <code>compareFit</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>comp123 <span class="ot">&lt;-</span> <span class="fu">compareFit</span>(fit3a, fit2a, fit1a)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp123)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

      Df    AIC    BIC   Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit3a 18 7573.9 7633.2  18.108                                          
fit2a 19 7592.1 7648.2  38.325     20.217 0.30998       1  6.913e-06 ***
fit1a 20 7657.2 7710.0 105.427     67.102 0.57490       1  2.578e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

####################### Model Fit Indices ###########################
         chisq df pvalue rmsea    cfi    tli  srmr       aic       bic
fit3a  18.108† 18   .449 .005† 1.000† 1.000† .035† 7573.864† 7633.234†
fit2a  38.325  19   .005 .071   .959   .939  .072  7592.082  7648.153 
fit1a 105.427  20   .000 .146   .818   .746  .084  7657.183  7709.956 

################## Differences in Fit Indices #######################
              df rmsea    cfi    tli  srmr    aic    bic
fit2a - fit3a  1 0.066 -0.041 -0.060 0.037 18.217 14.919
fit1a - fit2a  1 0.075 -0.141 -0.194 0.011 65.102 61.804</code></pre>
</div>
</div>
<p>The second table in the output includes commonly reported indices of approximate fit (e.g., RMSEA, CFI, SRMR).</p>
<p><strong>Take a closer look at these indices across the three models and determine for each model if it fit well (a) approximately or (b) exactly.</strong></p>
</section>
<section id="estimate-interpretation" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="estimate-interpretation"><span class="header-section-number">5.8</span> Estimate Interpretation</h2>
<p>Now that we’ve completed the model respecification cycle, we can interpret the results of our final model. First, we can look at the (unstandardized) parameter estimates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3a, <span class="at">std =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 49 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                                18.108
  Degrees of freedom                                18
  P-value (Chi-square)                           0.449

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sequent =~                                                            
    hm                1.000                               0.857    0.253
    nr                2.285    0.777    2.941    0.003    1.958    0.818
    wo                2.767    0.941    2.939    0.003    2.370    0.819
  Simult =~                                                             
    gc                1.000                               1.345    0.500
    tr                1.436    0.228    6.307    0.000    1.932    0.717
    sm                2.074    0.340    6.095    0.000    2.790    0.666
    ma                1.241    0.215    5.762    0.000    1.670    0.598
    ps                1.727    0.266    6.500    0.000    2.324    0.777
    hm                0.986    0.248    3.979    0.000    1.326    0.391

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sequent ~~                                                            
    Simult            0.587    0.231    2.546    0.011    0.510    0.510

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .hm                7.851    0.845    9.291    0.000    7.851    0.683
   .nr                1.899    0.487    3.896    0.000    1.899    0.331
   .wo                2.750    0.713    3.856    0.000    2.750    0.329
   .gc                5.444    0.585    9.297    0.000    5.444    0.750
   .tr                3.521    0.457    7.702    0.000    3.521    0.485
   .sm                9.767    1.179    8.287    0.000    9.767    0.556
   .ma                5.013    0.569    8.815    0.000    5.013    0.643
   .ps                3.554    0.529    6.718    0.000    3.554    0.397
    Sequent           0.734    0.490    1.499    0.134    1.000    1.000
    Simult            1.810    0.526    3.444    0.001    1.000    1.000

R-Square:
                   Estimate
    hm                0.317
    nr                0.669
    wo                0.671
    gc                0.250
    tr                0.515
    sm                0.444
    ma                0.357
    ps                0.603</code></pre>
</div>
</div>
<p>The unstandardized estimates are mostly used to evaluate significance of the different parameter estimates. When using CFA, the focus is typically on interpreting the standardized estimates. Standardized factor loadings’ interpretation depends on whether an indicator loads on one or multiple factors.</p>
<ul>
<li>One factor loading: can be interpreted as Pearson correlations between the indicators and their factor.</li>
<li>Multiple factor (cross)loadings: can be interpreted as standardized regression estimates, indicating the expected change in the indicator in standard deviation units, for a one standard deviation increase in factor A, holding factor B constant.</li>
</ul>
<p>In the code above, we also requested R-squared estimates (<code>rsquare = T</code>). Ideally, factors should explain at least half of the variance in continuous indicators (R-square = .50), that would be excellent. Values near .40 are very good, near .30 are good, near .20 are fair, and near .10 are poor. What kind of R-square is acceptable depends on the purpose that the latent factor will be used for. If the factors are used to make high-stakes decisions you’d want the indicators to share a lot of common variance, which means higher R-squareds.</p>
</section>
<section id="reliability-based-on-factor-models" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="reliability-based-on-factor-models"><span class="header-section-number">5.9</span> Reliability based on factor models</h2>
<p>We can estimate the reliability/internal consistency with Coefficient omega, which can be interpreted in a similar manner as Cronbach’s alpha, but takes into account that the indicators are caused by a shared common factor with differing degrees of association (i.e., different factor loadings). We can use the <code>compRelSEM()</code> function from the semTools package to compute coefficient Omega:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compRelSEM</span>(fit3a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sequent  Simult 
  0.559   0.737 </code></pre>
</div>
</div>
<p><strong>How would you interpret the reliability of these two factors?</strong></p>
</section>
<section id="summary" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.10</span> Summary</h2>
<p>In this R lab, you were introduced to the steps involved in specifying, estimating, evaluating, comparing and interpreting the results of confirmatory factor analyses. Below, you’ll find a Bonus section that demonstrates how to include a residual covariance in a CFA model. In the next R Lab, you will learn all about structural equation modeling, combining the power of path analyses and CFAs.</p>
</section>
<section id="bonus-adding-a-residual-covariance" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="bonus-adding-a-residual-covariance"><span class="header-section-number">5.11</span> Bonus: Adding a residual covariance</h2>
<p>To add a residual covariance between two indicators, we use the <code>~~</code> operator:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="st">Sequent =~ hm + nr + wo</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">Simult =~ gc + tr + sm + ma + ps </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">nr ~~ wo</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can estimate the model and save it in <code>fit4a</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fit4a <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="at">model =</span> mod4, <span class="at">data =</span> kabc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-evaluation-3" class="level3">
<h3 class="anchored" data-anchor-id="model-evaluation-3">Model Evaluation</h3>
<section id="global-fit-3" class="level4">
<h4 class="anchored" data-anchor-id="global-fit-3">Global Fit</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4a, <span class="at">fit.measures =</span> T, <span class="at">estimates =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 57 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                                18.108
  Degrees of freedom                                18
  P-value (Chi-square)                           0.449

Model Test Baseline Model:

  Test statistic                               498.336
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.000

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3768.932
  Loglikelihood unrestricted model (H1)      -3759.878
                                                      
  Akaike (AIC)                                7573.864
  Bayesian (BIC)                              7633.234
  Sample-size adjusted Bayesian (SABIC)       7576.208

Root Mean Square Error of Approximation:

  RMSEA                                          0.005
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.063
  P-value H_0: RMSEA &lt;= 0.050                    0.859
  P-value H_0: RMSEA &gt;= 0.080                    0.008

Standardized Root Mean Square Residual:

  SRMR                                           0.035</code></pre>
</div>
</div>
</section>
<section id="local-fit-3" class="level4">
<h4 class="anchored" data-anchor-id="local-fit-3">Local Fit</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit4a, <span class="at">type =</span> <span class="st">"normalized"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "normalized"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  0.270  0.000                                          
wo -0.271  0.000  0.000                                   
gc -0.688 -1.380 -0.678  0.000                            
tr -0.713 -0.395 -0.130  0.286  0.000                     
sm  0.706  0.169  0.026 -0.443 -0.099  0.000              
ma  1.044  0.955  0.682  0.154 -0.115  0.155  0.000       
ps -0.181 -0.457  0.606  0.418  0.280 -0.091 -0.577  0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit4a, <span class="at">type =</span> <span class="st">"cor.bollen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$type
[1] "cor.bollen"

$cov
       hm     nr     wo     gc     tr     sm     ma     ps
hm  0.000                                                 
nr  0.020  0.000                                          
wo -0.020  0.000  0.000                                   
gc -0.050 -0.098 -0.049  0.000                            
tr -0.053 -0.029 -0.010  0.022  0.000                     
sm  0.054  0.012  0.002 -0.033 -0.008  0.000              
ma  0.079  0.071  0.050  0.011 -0.009  0.012  0.000       
ps -0.014 -0.034  0.046  0.032  0.023 -0.007 -0.044  0.000</code></pre>
</div>
</div>
</section>
</section>
<section id="model-comparison-2" class="level3">
<h3 class="anchored" data-anchor-id="model-comparison-2">Model Comparison</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>comp24 <span class="ot">&lt;-</span> <span class="fu">compareFit</span>(fit4a, fit2a)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>################### Nested Model Comparison #########################

Chi-Squared Difference Test

      Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)    
fit4a 18 7573.9 7633.2 18.108                                          
fit2a 19 7592.1 7648.2 38.325     20.217 0.30998       1  6.913e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

####################### Model Fit Indices ###########################
        chisq df pvalue rmsea    cfi    tli  srmr       aic       bic
fit4a 18.108† 18   .449 .005† 1.000† 1.000† .035† 7573.864† 7633.234†
fit2a 38.325  19   .005 .071   .959   .939  .072  7592.082  7648.153 

################## Differences in Fit Indices #######################
              df rmsea    cfi   tli  srmr    aic    bic
fit2a - fit4a  1 0.066 -0.041 -0.06 0.037 18.217 14.919</code></pre>
</div>
</div>
</section>
<section id="estimate-interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="estimate-interpretation-1">Estimate Interpretation</h3>
<p>Take a look at the estimates and note the differences in standardized estimates and R-squared across the two models (with cross-loading or with residual covariance).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit4a, <span class="at">std =</span> T, <span class="at">rsquare =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 57 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           200

Model Test User Model:
                                                      
  Test statistic                                18.108
  Degrees of freedom                                18
  P-value (Chi-square)                           0.449

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  Sequent =~                                                            
    hm                1.000                               2.303    0.679
    nr                0.566    0.107    5.284    0.000    1.303    0.544
    wo                0.685    0.129    5.292    0.000    1.578    0.545
  Simult =~                                                             
    gc                1.000                               1.345    0.500
    tr                1.436    0.228    6.307    0.000    1.932    0.717
    sm                2.074    0.340    6.095    0.000    2.790    0.666
    ma                1.241    0.215    5.762    0.000    1.670    0.598
    ps                1.727    0.266    6.500    0.000    2.324    0.777

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .nr ~~                                                                 
   .wo                2.584    0.516    5.007    0.000    2.584    0.531
  Sequent ~~                                                            
    Simult            2.372    0.504    4.703    0.000    0.766    0.766

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .hm                6.200    1.070    5.792    0.000    6.200    0.539
   .nr                4.033    0.509    7.922    0.000    4.033    0.704
   .wo                5.879    0.743    7.912    0.000    5.879    0.703
   .gc                5.444    0.585    9.297    0.000    5.444    0.750
   .tr                3.521    0.457    7.702    0.000    3.521    0.485
   .sm                9.767    1.179    8.287    0.000    9.767    0.556
   .ma                5.013    0.569    8.815    0.000    5.013    0.643
   .ps                3.554    0.529    6.718    0.000    3.554    0.397
    Sequent           5.302    1.304    4.066    0.000    1.000    1.000
    Simult            1.810    0.526    3.444    0.001    1.000    1.000

R-Square:
                   Estimate
    hm                0.461
    nr                0.296
    wo                0.297
    gc                0.250
    tr                0.515
    sm                0.444
    ma                0.357
    ps                0.603</code></pre>
</div>
</div>
</section>
<section id="reliability-based-on-factor-models-1" class="level3">
<h3 class="anchored" data-anchor-id="reliability-based-on-factor-models-1">Reliability based on factor models</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compRelSEM</span>(fit4a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sequent  Simult 
  0.559   0.790 </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./modelevaluation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model Evaluation and Comparison</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sem.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Structural Equation Modeling</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2025, Sonja D. Winter</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>