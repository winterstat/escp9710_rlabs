<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>ESCP 9710 R Labs - 11&nbsp; Latent Profile Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lca.html" rel="next">
<link href="./measurementinvariance_ord.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">ESCP 9710 R Labs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/people.html" rel="" target="">
 <span class="menu-text">People</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/publications.html" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://winterstat.github.io/talks.html" rel="" target="">
 <span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-r-labs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">R Labs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-r-labs">    
        <li>
    <a class="dropdown-item" href="https://winterstat.github.io/escp8082_rlabs" rel="" target="">
 <span class="dropdown-text">ESCP 8082 Foundations of Measurement</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.twitter.com/winterstat" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/winterstat" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lpa.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Latent Profile Analysis</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./gettingstarted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathanalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Path Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./indirecteffects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Indirect Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelevaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Model Evaluation and Comparison</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confirmatoryfactoranalysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Confirmatory Factor Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Structural Equation Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurementinvariance_cont.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Measurement Invariance Testing with Continuous Indicators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sam.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Structural after Measurement Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./latentgrowthmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Latent Growth Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./measurementinvariance_ord.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Measurement Invariance Testing with Ordinal Indicators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lpa.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Latent Profile Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Latent Class Analysis</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link active" data-scroll-target="#loading-r-packages"><span class="header-section-number">11.1</span> Loading R Packages</a></li>
  <li><a href="#loading-data" id="toc-loading-data" class="nav-link" data-scroll-target="#loading-data"><span class="header-section-number">11.2</span> Loading Data</a></li>
  <li><a href="#estimate-range-of-latent-profile-solutions" id="toc-estimate-range-of-latent-profile-solutions" class="nav-link" data-scroll-target="#estimate-range-of-latent-profile-solutions"><span class="header-section-number">11.3</span> Estimate range of latent profile solutions</a></li>
  <li><a href="#profile-solution-comparison" id="toc-profile-solution-comparison" class="nav-link" data-scroll-target="#profile-solution-comparison"><span class="header-section-number">11.4</span> Profile Solution Comparison</a>
  <ul class="collapse">
  <li><a href="#lo-mendell-rubin-likelihood-ratio-test" id="toc-lo-mendell-rubin-likelihood-ratio-test" class="nav-link" data-scroll-target="#lo-mendell-rubin-likelihood-ratio-test">Lo-Mendell-Rubin Likelihood Ratio Test</a></li>
  <li><a href="#bootstrapped-likelihood-ratio-test" id="toc-bootstrapped-likelihood-ratio-test" class="nav-link" data-scroll-target="#bootstrapped-likelihood-ratio-test">Bootstrapped Likelihood Ratio Test</a></li>
  </ul></li>
  <li><a href="#alternative-model-specification" id="toc-alternative-model-specification" class="nav-link" data-scroll-target="#alternative-model-specification"><span class="header-section-number">11.5</span> Alternative Model Specification</a></li>
  <li><a href="#interpreting-final-model-results" id="toc-interpreting-final-model-results" class="nav-link" data-scroll-target="#interpreting-final-model-results"><span class="header-section-number">11.6</span> Interpreting Final Model Results</a>
  <ul class="collapse">
  <li><a href="#classification-diagnostics" id="toc-classification-diagnostics" class="nav-link" data-scroll-target="#classification-diagnostics">Classification Diagnostics</a></li>
  <li><a href="#parameter-estimates" id="toc-parameter-estimates" class="nav-link" data-scroll-target="#parameter-estimates">Parameter Estimates</a></li>
  <li><a href="#visualize-the-profiles" id="toc-visualize-the-profiles" class="nav-link" data-scroll-target="#visualize-the-profiles">Visualize the Profiles</a></li>
  </ul></li>
  <li><a href="#auxiliary-analyses" id="toc-auxiliary-analyses" class="nav-link" data-scroll-target="#auxiliary-analyses"><span class="header-section-number">11.7</span> Auxiliary Analyses</a></li>
  <li><a href="#predicting-membership-for-new-individuals" id="toc-predicting-membership-for-new-individuals" class="nav-link" data-scroll-target="#predicting-membership-for-new-individuals"><span class="header-section-number">11.8</span> Predicting membership for new individuals</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">11.9</span> Summary</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Latent Profile Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="loading-r-packages" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="loading-r-packages"><span class="header-section-number">11.1</span> Loading R Packages</h2>
<p>Load the required packages for this lab into your R environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidySEM)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-data" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="loading-data"><span class="header-section-number">11.2</span> Loading Data</h2>
<p>Load the data into your environment. For this lab we will use a dataset based on N = 441 children whose caregivers completed a survey about family environment and child behavior. You can download the data by right-clicking this link and selecting “Save Link As…” in the drop-down menu: <a href="https://winterstat.github.io/escp9710_rlabs/data/projectkids.csv">data/projectkids.csv</a>. Make sure to save it in the folder you are using for this class.</p>
<p>The full dataset and more information about this project can be found here: <a href="https://www.ldbase.org/datasets/72ab9852-8ebc-4ba0-bb1f-5f1c347e2572" class="uri">https://www.ldbase.org/datasets/72ab9852-8ebc-4ba0-bb1f-5f1c347e2572</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>kids <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/projectkids.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame with auxiliary outcome included</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>kids_aux <span class="ot">&lt;-</span> kids <span class="sc">%&gt;%</span> <span class="fu">select</span>(chaos1<span class="sc">:</span>chaos6, hpc_mean) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame with just PLA indicators</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>kids_chaos <span class="ot">&lt;-</span> kids_aux <span class="sc">%&gt;%</span> <span class="fu">select</span>(chaos1<span class="sc">:</span>chaos6) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">chaos1 =</span> <span class="dv">6</span> <span class="sc">-</span> chaos1,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">chaos4 =</span> <span class="dv">6</span> <span class="sc">-</span> chaos4,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">chaos6 =</span> <span class="dv">6</span> <span class="sc">-</span> chaos6)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(kids_chaos) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bedtimeroutine"</span>, <span class="st">"hearthink"</span>, <span class="st">"zoo"</span>, <span class="st">"stayontop"</span>, <span class="st">"tvon"</span>, <span class="st">"calm"</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(kids_aux) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bedtimeroutine"</span>, <span class="st">"hearthink"</span>, <span class="st">"zoo"</span>, <span class="st">"stayontop"</span>, <span class="st">"tvon"</span>, <span class="st">"calm"</span>, <span class="st">"hpc_mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will focus on the six items of the Confusion, Hubbub, and Order Scale (CHAOS). I had originally re-coded 3 items for our use of these in CFA and SEM models, but we will un-recode them here so we can interpret them according to the original item content:</p>
<ul>
<li>My child has a regular bedtime routine (e.g.&nbsp;same bedtime each night, brushing teeth, reading a story)</li>
<li>You can’t hear yourself think in our home</li>
<li>It’s a real zoo in our home</li>
<li>We are usually able to stay on top of things</li>
<li>There is usually a television turned on somewhere in our home</li>
<li>The atmosphere in our house is calm</li>
</ul>
<p>The <code>tidySEM</code> package has a function <code>descriptives()</code> that we can use to get some basic descriptive statistics for our items:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>desc <span class="ot">&lt;-</span> <span class="fu">descriptives</span>(kids_chaos)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>desc <span class="ot">&lt;-</span> desc[, <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"n"</span>, <span class="st">"missing"</span>, <span class="st">"unique"</span>, <span class="st">"mean"</span>, <span class="st">"median"</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sd"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>)]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>desc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            name   n missing unique     mean median        sd min max
1 bedtimeroutine 429       0      5 4.170163      4 1.0305816   1   5
2      hearthink 429       0      5 1.939394      1 1.2365390   1   5
3            zoo 429       0      5 1.731935      1 1.1024320   1   5
4      stayontop 429       0      5 4.081585      4 0.9717319   1   5
5           tvon 429       0      5 3.706294      4 1.2237840   1   5
6           calm 429       0      5 3.902098      4 1.0275278   1   5</code></pre>
</div>
</div>
<p>We can also use <code>ggplot()</code> to visualize the distribution of item responses:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>chaos_plot <span class="ot">&lt;-</span> kids_chaos</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(chaos_plot) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Value."</span>, <span class="fu">names</span>(chaos_plot))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>chaos_plot <span class="ot">&lt;-</span> <span class="fu">reshape</span>(chaos_plot, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">varying =</span> <span class="fu">names</span>(chaos_plot), </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"long"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">timevar =</span> <span class="st">"Variable"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chaos_plot, <span class="fu">aes</span>(<span class="at">x =</span> Value)) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Variable) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lpa_files/figure-html/descplot-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Why is it not a problem for LPA that the item responses are not normally distributed?</strong></p>
</section>
<section id="estimate-range-of-latent-profile-solutions" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="estimate-range-of-latent-profile-solutions"><span class="header-section-number">11.3</span> Estimate range of latent profile solutions</h2>
<p>We typically come into an LPA with some theory-based expectations for how many profiles might exist in the population. In addition, our overall sample size might put some restrictions on how many classes can feasibly be estimated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9710</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">mx_profiles</span>(<span class="at">data =</span> kids_chaos, <span class="at">classes =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(res, <span class="at">file =</span> <span class="st">"data/LPA_results.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Instead of running the code below, you can download the results by <a href="https://winterstat.github.io/escp9710_rlabs/data/LPA_results.RDS">right-clicking here</a> and saving it into the data folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/LPA_results.RDS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="profile-solution-comparison" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="profile-solution-comparison"><span class="header-section-number">11.4</span> Profile Solution Comparison</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">table_fit</span>(res)  <span class="co"># model fit table</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fit[, <span class="fu">c</span>(<span class="st">"Name"</span>, <span class="st">"LL"</span>, <span class="st">"Parameters"</span>, <span class="st">"n"</span>, <span class="st">"BIC"</span>, <span class="st">"Entropy"</span>, <span class="st">"prob_min"</span>,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"prob_max"</span>, <span class="st">"n_min"</span>, <span class="st">"n_max"</span>, <span class="st">"np_ratio"</span>, <span class="st">"np_local"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Name        LL Parameters   n      BIC   Entropy  prob_min  prob_max
1 equal var 1 -3881.170         12 429 7835.077 1.0000000 1.0000000 1.0000000
2 equal var 2 -3661.732         19 429 7438.632 0.9218451 0.9569456 0.9868002
3 equal var 3 -3621.222         26 429 7400.042 0.8642157 0.8670854 0.9686615
4 equal var 4 -3561.982         33 429 7323.992 0.8823549 0.8545100 0.9644465
       n_min     n_max np_ratio np_local
1 1.00000000 1.0000000 35.75000 35.75000
2 0.26806527 0.7319347 22.57895 12.77778
3 0.18648019 0.5664336 16.50000 10.00000
4 0.07692308 0.5361305 13.00000  4.40000</code></pre>
</div>
</div>
<p><strong>What profile solution is preferred according to the BIC?</strong></p>
<p>We might want to explore additional profile solutions, but we can see that, with four profiles, there are only about 4.4 observations per parameter in every profile, which is already quite low. Estimating additional profiles may cause the model to not be identified within profiles. We can visualize the drop in BIC across profile solutions using the <code>plot()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lpa_files/figure-html/plotfit-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The output above also gives us information about the entropy of the model. This value provides a summary of profile separation. It actually represents <span class="math inline">\(1-entropyy\)</span> but most people who use it for mixture models report it as simply entropy. If entropy is 0, there is no separations between profiles, their response distributions overlap fully. If entropy is 1, all profiles are fully separated, their response distributions are completely separated. So, higher values are preferred.</p>
<section id="lo-mendell-rubin-likelihood-ratio-test" class="level3">
<h3 class="anchored" data-anchor-id="lo-mendell-rubin-likelihood-ratio-test">Lo-Mendell-Rubin Likelihood Ratio Test</h3>
<p>We can also use the Lo-Mendell-Rubin Likelihood Ratio Test (LMR-LRT) to make pairwise comparisons across model solutions to test the Null hypothesis that two profile solutions have equivalent fit (so a p-value &lt; .05 indicates that one model fits better than the other).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lr_lmr</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lo-Mendell-Rubin adjusted Likelihood Ratio Test:

 null  alt   lr df        p    w2     p_w2
 mix1 mix2 8.27  7 2.22e-16 1.641 9.63e-09
 mix2 mix3 3.20  7 6.92e-04 0.374 3.98e-04
 mix3 mix4 4.05  7 2.54e-05 0.498 2.39e-02</code></pre>
</div>
</div>
</section>
<section id="bootstrapped-likelihood-ratio-test" class="level3">
<h3 class="anchored" data-anchor-id="bootstrapped-likelihood-ratio-test">Bootstrapped Likelihood Ratio Test</h3>
<p>An alternative to the LMR-LRT is the bootstrapped likelihood ratio test. This approach is very computationally expensive (i.e., slow), so we only ask for 10 bootstrapped samples here. For a publication you should use a much higher number (1000+). You can use packages such as the <code>future</code> package to use multiple CPUs and speed things up with parallel computing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>res_blrt <span class="ot">&lt;-</span> <span class="fu">BLRT</span>(res, <span class="at">replications =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="alternative-model-specification" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="alternative-model-specification"><span class="header-section-number">11.5</span> Alternative Model Specification</h2>
<p>We assumed that the indicators would have equivalent variances across profiles and that there would not be any covariances among indicators within a profile. However, a reviewer might doubt those assumptions and ask to compare the selected profile-solution to a model with the same number of profiles, but allowing the variances to vary across profiles. Note that allowing varying variances (or covariances within profiles) result in more complex models (i.e., we need to estimate more parameters), which may be challenging to estimate with smaller samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>res_alt <span class="ot">&lt;-</span> <span class="fu">mx_profiles</span>(kids_chaos, <span class="at">classes =</span> <span class="dv">4</span>, <span class="at">variances =</span> <span class="st">"varying"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running mix4 with 51 parameters
Running mix4 with 51 parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In model 'mix4' Optimizer returned a non-zero status code 6. The model
does not satisfy the first-order optimality conditions to the required
accuracy, and no improved point for the merit function could be found during
the final linesearch (Mx status RED)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The example below shows you how to have varying variances + covariances within classes</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#res_alt &lt;- mx_profiles(kids_chaos, classes = 4, variances = "varying", covariances = "varying")</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="fu">list</span>(res[[<span class="dv">4</span>]], res_alt)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table_fit</span>(compare)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Name Classes         LL   n Parameters      AIC      BIC    saBIC   Entropy
1    1       4 -3561.9821 429         33 7189.964 7323.992 7219.270 0.8823549
2    2       4  -595.8179 429         51 1293.636 1500.770 1338.927 0.9445174
   prob_min  prob_max      n_min     n_max warning  np_ratio np_local
1 0.8545100 0.9644465 0.07692308 0.5361305      NA 13.000000      4.4
2 0.8295987 1.0000000 0.11188811 0.5034965    TRUE  8.411765      4.0</code></pre>
</div>
</div>
</section>
<section id="interpreting-final-model-results" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="interpreting-final-model-results"><span class="header-section-number">11.6</span> Interpreting Final Model Results</h2>
<p>Before interpreting final estimates, we reorder the latent profiles so that they are arranged from largest to smallest:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>res_final <span class="ot">&lt;-</span> <span class="fu">mx_switch_labels</span>(res[[<span class="dv">4</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="classification-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="classification-diagnostics">Classification Diagnostics</h3>
<p>We can look at several indicators of classification accuracy and reliability. First, we can look at how many individuals are classified into each profile based on their highest posterior probability:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class_prob</span>(res_final, <span class="at">type =</span> <span class="st">"sum.mostlikely"</span>) <span class="co"># assumes no classification error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$sum.mostlikely
   class count proportion
1 class1   230 0.53613054
2 class2   105 0.24475524
3 class3    61 0.14219114
4 class4    33 0.07692308</code></pre>
</div>
</div>
<p>The estimates above assume that each participant is classified into the correct profile (does not incorporate any uncertainty). We can also ask for estimates that do account for that uncertainty. If there is no classification error (i.e., every person is classified into 1 profile with 100% certainty), the above table would be identical to the below table (which does account for error):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class_prob</span>(res_final, <span class="at">type =</span> <span class="st">"sum.posterior"</span>) <span class="co"># includes classification error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$sum.posterior
   class     count proportion
1 class1 224.62794 0.52360825
2 class2 105.39364 0.24567283
3 class3  64.42088 0.15016523
4 class4  34.55753 0.08055369</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#class_prob(res_final, type = "individual") # classification probabilities for each individual</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Are there any major differences between the two classification tables? What does that say about the severity of classification errors?</strong></p>
<p>Next, we can use a cross-table to understand the certainty of our classifications better. Again, we can either ignore classification error, using the functions below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class_prob</span>(res_final, <span class="at">type =</span> <span class="st">"mostlikely.class"</span>) <span class="co"># values on diagonal should be &gt; .7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$mostlikely.class
          assigned.1 assigned.2  assigned.3   assigned.4
avgprob.1 0.96444654 0.01305278 0.021596558 0.0009041203
avgprob.2 0.04098968 0.94543631 0.009017845 0.0045561610
avgprob.3 0.11814948 0.02026233 0.854509954 0.0070782420
avgprob.4 0.04109700 0.03245069 0.004305713 0.9221465912</code></pre>
</div>
</div>
<p>Or we can include classification error, using the function below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class_prob</span>(res_final, <span class="at">type =</span> <span class="st">"avg.mostlikely"</span>) <span class="co"># values on diagonal should be &gt; .7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$avg.mostlikely
           meanprob.class1 meanprob.class2 meanprob.class3 meanprob.class4
assigned.1     0.941950580      0.01878253      0.03309330     0.006173593
assigned.2     0.027924892      0.94896524      0.01243186     0.010678011
assigned.3     0.079530277      0.01558046      0.90245049     0.002438771
assigned.4     0.006154462      0.01455099      0.01381808     0.965476476</code></pre>
</div>
</div>
<p>For both tables, values on the diagonal represent classification certainty and should be close to 1.</p>
<p><strong>For which of these classes is classification certainty lowest?</strong></p>
</section>
<section id="parameter-estimates" class="level3">
<h3 class="anchored" data-anchor-id="parameter-estimates">Parameter Estimates</h3>
<p>Now that we’ve evaluated the classification diagnostics, we can interpret the parameter estimates, using the <code>table_results()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table_results</span>(res_final, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"label"</span>, <span class="st">"est"</span>, <span class="st">"se"</span>, <span class="st">"confint"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"class"</span>)) <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> label, <span class="at">names_from =</span> class, <span class="at">values_from =</span> est<span class="sc">:</span>confint, <span class="at">names_vary =</span> <span class="st">"slowest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 16
   label est_class1 se_class1 confint_class1 est_class2 se_class2 confint_class2
   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;         
 1 Mean… 4.27       0.07      [4.13, 4.41]   3.99       0.11      [3.78, 4.19]  
 2 Mean… 1.25       0.05      [1.15, 1.35]   3.71       0.08      [3.55, 3.87]  
 3 Mean… 1.18       0.06      [1.07, 1.30]   3.02       0.09      [2.84, 3.20]  
 4 Mean… 4.40       0.05      [4.32, 4.49]   4.00       0.07      [3.85, 4.14]  
 5 Mean… 4.14       0.07      [4.00, 4.28]   4.18       0.09      [3.99, 4.36]  
 6 Mean… 4.17       0.07      [4.04, 4.30]   3.25       0.10      [3.06, 3.44]  
 7 Vari… 1.04       0.07      [0.90, 1.18]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
 8 Vari… 0.48       0.05      [0.38, 0.59]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
 9 Vari… 0.64       0.05      [0.54, 0.74]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
10 Vari… 0.43       0.04      [0.36, 0.50]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
11 Vari… 0.72       0.06      [0.60, 0.85]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
12 Vari… 0.88       0.06      [0.76, 1.00]   &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
13 mix4… &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
14 mix4… &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
15 mix4… &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
16 mix4… &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;           &lt;NA&gt;       &lt;NA&gt;      &lt;NA&gt;          
# ℹ 9 more variables: est_class3 &lt;chr&gt;, se_class3 &lt;chr&gt;, confint_class3 &lt;chr&gt;,
#   est_class4 &lt;chr&gt;, se_class4 &lt;chr&gt;, confint_class4 &lt;chr&gt;, est_NA &lt;chr&gt;,
#   se_NA &lt;chr&gt;, confint_NA &lt;chr&gt;</code></pre>
</div>
</div>
<p>The output above includes mean estimates for the 6 CHAOS items for each of the four profiles. In addition, this model estimated one set of variance estimates for the 6 CHAOS items that apply to all four profiles. Finally, there is a set of relative weights which repesent the profile sizes relative to the largest class (i.e., class 4 is 15% of the size of class 1).</p>
<p>To make it easier to see if estimates vary across profiles, we can reorganize this table and focus on the confidence intervals (i.e., if intervals do not overlap then that estimate differs across those profiles):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table_results</span>(res_final, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"label"</span>, <span class="st">"confint"</span>, <span class="st">"class"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(label, <span class="st">"Means"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> label, </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">names_from =</span> class, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> confint)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  label                class1       class2       class3       class4      
  &lt;chr&gt;                &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;       
1 Means.bedtimeroutine [4.13, 4.41] [3.78, 4.19] [4.01, 4.54] [3.52, 4.29]
2 Means.hearthink      [1.15, 1.35] [3.55, 3.87] [1.38, 1.80] [1.35, 2.00]
3 Means.zoo            [1.07, 1.30] [2.84, 3.20] [1.49, 1.94] [1.11, 1.70]
4 Means.stayontop      [4.32, 4.49] [3.85, 4.14] [4.18, 4.53] [1.47, 1.98]
5 Means.tvon           [4.00, 4.28] [3.99, 4.36] [1.44, 1.99] [2.87, 3.48]
6 Means.calm           [4.04, 4.30] [3.06, 3.44] [3.99, 4.49] [3.19, 3.85]</code></pre>
</div>
</div>
<ul>
<li>We can see that the 95% CIs for the bedtime routine item all overlap, so this item is not really differentiating between profiles.</li>
<li>In contrast, the 95% CI the can’t hear myself think item do not overlap when comparing profile 1 to profiles 2, 3, and 4. In addition, profile 2 and 4 also do not have overlapping CIs. People assigned to profile 1 (and to a lesser extent profile 4) do not endorse this item to the same extend as those classified in the other profiles.</li>
<li>For the zoo item, the 95% CI of profile 1 does not overlap with profile 2 and 3. And profile 2 does not overlap with profiles 3 and 4. Overall, it seems the people assigned to profile 2 endorse this item more than those classified in other profiles.</li>
<li>For the stay on top of things item, it appears that those classified in profile 4 do not endorse this item to the same extent as the other profiles. Profile 3 endorses it more than profile 2 but the CI overlaps with that of profile 1.</li>
<li>The TV is always on item is least endorsed by those in profile 3, followed by profile 4, and finally profiles 1 and 2. Thus, this part of “chaos” is not characteristic of profiles 3 and 4.</li>
<li>Finally, the calm atmosphere item is least endorsed by profiles 2 and 4, and most endorsed by profiles 1 and 3.</li>
</ul>
<p>Based on these results it appears that all parents, regardless of profile, have a good bedtime routine down. But responses to other items seem to differentiate between different profiles quite well.</p>
</section>
<section id="visualize-the-profiles" class="level3">
<h3 class="anchored" data-anchor-id="visualize-the-profiles">Visualize the Profiles</h3>
<p>Tables can provide a lot of detail, but it can be challenging to unnderstand the bigger picture. That’s why we like to visualize response patterns of the latent profiles. The <code>plot_profile()</code> function includes all profiles in one plot, which can be difficult to decipher. For that reason, I save the original plot into object <code>p</code> and then use the <code>facet_wrap()</code> function from the <code>ggplot2</code> package to split the plot into separate subplots for each class:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plot_profiles</span>(res_final) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="lpa_files/figure-html/plotprofile-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>Class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using shapes for an ordinal variable is not advised</code></pre>
</div>
<div class="cell-output-display">
<p><img src="lpa_files/figure-html/plotprofile-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>What label would you give each of these profiles?</strong></p>
</section>
</section>
<section id="auxiliary-analyses" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="auxiliary-analyses"><span class="header-section-number">11.7</span> Auxiliary Analyses</h2>
<p>We can extend the LPA with auxiliary variables or analyses. For example, we can see if kids of parents in different profiles report different amounts of homework problems using the <code>hpc_mean</code> variable. We use the Bolck, Croon, and Hagenaars (BCH) approach, which separates the LPA model from the auxiliary analysis and incorporates classification uncertainty (conceptually similar to SAM).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>aux_hpc <span class="ot">&lt;-</span> <span class="fu">BCH</span>(res_final, <span class="at">data =</span> kids_aux<span class="sc">$</span>hpc_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running aux with 8 parameters</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aux_hpc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Summary of aux 
 
free parameters:
           name   matrix row col  Estimate  Std.Error A
1 class1.S[1,1] class1.S   y   y 0.3227898 0.03045759  
2 class1.M[1,1] class1.M   1   y 1.6409456 0.03790711  
3 class2.S[1,1] class2.S   y   y 0.5796778 0.07985333  
4 class2.M[1,1] class2.M   1   y 1.8342364 0.07416326  
5 class3.S[1,1] class3.S   y   y 0.2788413 0.04913082  
6 class3.M[1,1] class3.M   1   y 1.5031372 0.06579004  
7 class4.S[1,1] class4.S   y   y 0.3768246 0.09066187  
8 class4.M[1,1] class4.M   1   y 1.7839324 0.10443393  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:              8                    419              789.9786
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1716/427

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:      -48.02136               805.9786                 806.0630
BIC:    -2330.62915               849.5606                 824.1455
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2025-02-04 10:27:16 
Wall clock time: 0.397243 secs 
optimizer:  SLSQP 
OpenMx version number: 2.21.13 
Need help?  See help(mxSummary) </code></pre>
</div>
</div>
<p>We can test the equivalence of the homework problem means across profiles using the <code>lr_test()</code> function. It compares a model in which all means are fixed to be equal to a model where the means are freely estimated for an overall test, followed by pairwise comparisons in which two specific profile’s are compared.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lr_test</span>(aux_hpc, <span class="at">compare =</span> <span class="st">"M"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running aux with 5 parameters</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Running aux with 7 parameters
Running aux with 7 parameters
Running aux with 7 parameters
Running aux with 7 parameters
Running aux with 7 parameters
Running aux with 7 parameters</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>BCH test for equality of means across classes

Overall likelihood ratio test:
 LL_baseline LL_restricted   LL_dif df           p
    789.9786      802.4116 12.43296  3 0.006038032

Pairwise comparisons using likelihood ratio tests:
 Model1 Model2 LL_baseline LL_restricted     LL_dif df           p
 class1 class2    789.9786      795.2763  5.2976155  1 0.021354638
 class1 class3    789.9786      793.2242  3.2455609  1 0.071617175
 class2 class3    789.9786      800.7757 10.7970384  1 0.001016626
 class1 class4    789.9786      791.6045  1.6258622  1 0.202276317
 class2 class4    789.9786      790.1327  0.1540711  1 0.694674830
 class3 class4    789.9786      794.9453  4.9666828  1 0.025840160</code></pre>
</div>
</div>
<p>The global test suggests that there are differences between the profiles. Based on the pairwise comparison results, it appears that kids of parents in profile 3 have fewer homework problems than kids of parents in profile 2 and 4. And kids of parents in profile 1 have fewer homework problems than kids of parents in profile 2. Differences between other pairs of profiles are not significant.</p>
<p>You can test more complex auxiliary models as well, such as a linear regression model with homework problems as the outcome and sex or age of the child (or both!) as predictors.</p>
</section>
<section id="predicting-membership-for-new-individuals" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="predicting-membership-for-new-individuals"><span class="header-section-number">11.8</span> Predicting membership for new individuals</h2>
<p>Finally, you can use the LPA results to predict most likely class membership of new cases, as long as you have their scores on the indicator items. Below, I define a new participant with a somewhat inconsistent response pattern to see where they would end up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>kids_chaos_new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">bedtimeroutine =</span> <span class="dv">1</span>, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">hearthink =</span> <span class="dv">4</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">zoo =</span> <span class="dv">3</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                             <span class="at">stayontop =</span> <span class="dv">4</span>, </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">tvon =</span> <span class="dv">1</span>, </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">calm =</span> <span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(res_final, <span class="at">newdata =</span> kids_chaos_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Running mix4 with 0 parameters</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>          class1    class2      class3       class4 predicted
[1,] 1.70066e-06 0.9945138 0.005473939 1.052268e-05         2</code></pre>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="11.9">
<h2 data-number="11.9" class="anchored" data-anchor-id="summary"><span class="header-section-number">11.9</span> Summary</h2>
<p>In this R lab, you were introduced to the steps involved in specifying, estimating, evaluating, comparing and interpreting the results of latent profile analyses. In addition, you have seen some ways in which you can expand the basic LPA with an auxiliary model. In the next R Lab, you will learn about latent class analysis (LCA), which is similar to LPA but is based on ordinal indicators.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./measurementinvariance_ord.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Measurement Invariance Testing with Ordinal Indicators</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lca.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Latent Class Analysis</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2025, Sonja D. Winter</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>